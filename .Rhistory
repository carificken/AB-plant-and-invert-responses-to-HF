data=veg_exot,
REML=F)
rich.poly.exot <- lmer(rich ~ poly(totdist_percent,2) +
propexotic +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
rich.poly.exot.interaction <- lmer(rich ~ poly(totdist_percent,2) * propexotic +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
AIC(rich.polya, rich.exot.only, rich.poly.exot, rich.poly.exot.interaction)
anova(rich.polya, rich.exot.only, rich.poly.exot, rich.poly.exot.interaction)
summary(rich.poly.exot.interaction)
piecewiseSEM::rsquared(rich.polya)
piecewiseSEM::rsquared(rich.poly.exot.interaction) # best model
Moran.I(residuals(rich.poly.exot.interaction), rich.d.inv) # I=0.003
}
library(tidyverse); library(cowplot); library(ggrepel)
library(lme4)
library(ape)
rich.poly # previous best
# refit previous best w/ updated df that includes exotic
rich.polya <- lmer(rich ~ poly(totdist_percent,2) +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
rich.exot.only <- lmer(rich ~ propexotic +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
rich.poly.exot <- lmer(rich ~ poly(totdist_percent,2) +
propexotic +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
rich.poly.exot.interaction <- lmer(rich ~ poly(totdist_percent,2) * propexotic +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
AIC(rich.polya, rich.exot.only, rich.poly.exot, rich.poly.exot.interaction)
anova(rich.polya, rich.exot.only, rich.poly.exot, rich.poly.exot.interaction)
summary(rich.poly.exot.interaction)
library(lmerTest)
# refit previous best w/ updated df that includes exotic
rich.polya <- lmer(rich ~ poly(totdist_percent,2) +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
rich.exot.only <- lmer(rich ~ propexotic +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
rich.poly.exot <- lmer(rich ~ poly(totdist_percent,2) +
propexotic +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
rich.poly.exot.interaction <- lmer(rich ~ poly(totdist_percent,2) * propexotic +
Protocol +
(1|Year) + (1|UniqueID),
data=veg_exot,
REML=F)
AIC(rich.polya, rich.exot.only, rich.poly.exot, rich.poly.exot.interaction)
anova(rich.polya, rich.exot.only, rich.poly.exot, rich.poly.exot.interaction)
summary(rich.poly.exot.interaction)
head(veg_exot)
ggplot(veg_exot, aes(x=rich, y=CSI)) + geom_point()
ggplot(veg_exot, aes(x=rich, y=CSI)) + geom_point(aes(color=propexotic))
ggplot(veg_exot, aes(x=rich, y=CSI)) + geom_point(aes(color=propexotic)) + theme(legend.position = "top")
ggplot(veg_exot, aes(x=rich, y=CSI)) + geom_point(aes(color=propexotic)) + theme(legend.position = "top") + scale_color_viridis_c()
ggplot(veg_exot, aes(x=propexotic, y=CSI)) + geom_point()
ggplot(veg_exot, aes(x=propexotic, y=CSI)) + geom_point(aes(color=rich)) + scale_colorgradient2(low="blue", high="red")
ggplot(veg_exot, aes(x=propexotic, y=CSI)) + geom_point(aes(color=rich)) + scale_color_gradient2(low="blue", high="red")
?scale_color_gradient2
ggplot(veg_exot, aes(x=propexotic, y=CSI)) + geom_point(aes(color=rich)) + scale_color_gradient2(low="darkblue", high="red")
ggplot(veg_exot, aes(x=propexotic, y=CSI)) + geom_point(aes(color=rich)) + scale_color_gradient2(low="darkblue", high="red", midpoint=50)
ggplot(veg_exot, aes(x=propexotic, y=CSI)) + geom_point(aes(color=rich)) + scale_color_gradient2(low="darkblue", high="red", midpoint=40)
ggplot(veg_exot, aes(x=propexotic, y=rich)) + geom_point()
veg_exot
exotics <- read.csv("data/cleaned/exotic_plants_ab.csv", sep=";")
veg_exot <- left_join(veg_pa, exotics, by=c("Species"="SPECIES")) %>% select(-TYPE)
head(veg_exot)
veg_exot %>%
group_by(Latitude, Longitude, Protocol, Site,Year, ORIGIN) %>%
tally() %>%
spread(key=ORIGIN, value=n) %>% head()
veg_exot %>%
group_by(Latitude, Longitude, Protocol, Site,Year, ORIGIN) %>%
tally() %>%
spread(key=ORIGIN, value=n) -> tmp
veg_exot %>%
group_by(Latitude, Longitude, Protocol, Site,Year, ORIGIN) %>%
tally() %>%
spread(key=ORIGIN, value=n) %>% select(-Native, -'Unknown/Undetermined')
veg_exot <- veg_exot %>%
group_by(Latitude, Longitude, Protocol, Site,Year, ORIGIN) %>%
tally() %>%
spread(key=ORIGIN, value=n) %>%
replace_na(list(Exotic=0, Native=0,`Unknown/Undetermined`=0)) %>%
rowwise() %>%
mutate(rich=sum(Exotic, Native, `Unknown/Undetermined`),
propexotic=100*(Exotic/rich))
head(veg_exot)
left_join(veg_CSI_HF,
veg_exot,
by=c("Latitude", "Longitude", "Protocol", "Site", "Year")) %>%
select(-Native, -`Unknown/Undetermined`) -> tmp
head(tmp)
ggplot(tmp, aes(x=Exotic, y=rich)) + geom_point()
ggplot(tmp, aes(x=Exotic, y=rich)) + geom_point(aes(color=CSI))
ggplot(tmp, aes(x=Exotic, y=rich)) + geom_point(aes(color=CSI)) + scale_color_gradient2(low="blue", high="red", midpoint=1)
ggplot(tmp, aes(x=Exotic, y=rich)) + geom_point(aes(color=CSI)) + scale_color_gradient2(low="blue", high="red", midpoint=.5)
ggplot(tmp, aes(x=Exotic, y=rich)) + geom_point(aes(color=CSI)) + scale_color_gradient2(low="blue", high="red", midpoint=.8)
rm(list=ls())
# prep CSI, species richness, and exotic species data frames ####
{
# plant data ####
veg_pa <- read.csv("/users/carif/Dropbox/Desktop/Waterloo/AB plant and invert responses to HF/data/cleaned/ABMI veg cleaned_latlong.csv")
# load HF data ####
hf <- read.csv("/users/carif/Dropbox/Desktop/Waterloo/AB plant and invert responses to HF/data/cleaned/Alb wetlands HF_latlong.csv")
# calculate total disturbance ####
hf_tot <- hf %>% group_by(Latitude, Longitude, Protocol, NRNAME, WetlandType, Site, Year) %>% summarize(totdist_percent=sum(Area_percent))
# SSI from 1000 randomizations
{
sp_SSI <- read.csv("/users/carif/Dropbox/Desktop/Waterloo/AB plant and invert responses to HF/data/cleaned/ssi_final.csv", sep=";")
colnames(sp_SSI) <- c("Species", "CV")
}
# calculate CSI : mean CV of each community (also compare the summed CV of each community) ####
{
veg_CSI_HF <- left_join(veg_pa, sp_SSI)
veg_CSI_HF <- veg_CSI_HF %>%
group_by(Protocol,NRNAME, WetlandType,Site,Year) %>%
summarize(CSI=mean(CV, na.rm = T)) # 32 sites have na value for at least 1 sp
veg_CSI_HF <- left_join(veg_CSI_HF,hf_tot, by=c("NRNAME", "Protocol", "WetlandType", "Site", "Year"))
veg_CSI_HF$UniqueID <- paste(veg_CSI_HF$Protocol, veg_CSI_HF$Site, sep="_")
}
# make sp richness df
{
spR <- veg_pa %>% group_by(Latitude, Longitude, Protocol, NRNAME, WetlandType, Site, Year) %>%
summarize(rich=sum(PA))
spR <- inner_join(spR, hf_tot, by=c("Latitude", "Longitude", "Protocol", "NRNAME", "WetlandType", "Site", "Year"))
spR$UniqueID <- paste(spR$Protocol, spR$Site, sep="_")
}
# exotic species
{
exotics <- read.csv("data/cleaned/exotic_plants_ab.csv", sep=";")
veg_exot <- left_join(veg_pa, exotics, by=c("Species"="SPECIES")) %>% select(-TYPE)
veg_exot <- veg_exot %>%
group_by(Latitude, Longitude, Protocol, Site,Year, ORIGIN) %>%
tally() %>%
spread(key=ORIGIN, value=n) %>%
replace_na(list(Exotic=0, Native=0,`Unknown/Undetermined`=0)) %>%
rowwise() %>%
mutate(rich=sum(Exotic, Native, `Unknown/Undetermined`),
propexotic=100*(Exotic/rich))
veg_exot <- left_join(veg_CSI_HF,
veg_exot,
by=c("Latitude", "Longitude", "Protocol", "Site", "Year")) %>%
select(-Exotic, -Native, -`Unknown/Undetermined`)
}
}
fig1 <- ggplot(spR, aes(x=totdist_percent, y=rich)) +
labs(x="Total Human Development (%)", y="Species Richness") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=spR, aes(x=totdist_percent, y=rich, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top")
fig1
# black and white
fig2 <- ggplot(veg_CSI_HF, aes(x=totdist_percent, y=CSI)) +
labs(x="Total Human Development (%)", y="CSI to human develpoment") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=veg_CSI_HF, aes(x=totdist_percent, y=CSI, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top")
fig2
# two panel figure
myleg <- get_legend(fig1)
plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2)
plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2,
lables="auto")
plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2,
labels="auto")
fig1_twopanel <- plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2,
labels="auto")
plot_grid(myleg, fig1_twopanel, ncol=1, nrow=2,
rel_heights=c(0.1,1))
plot_grid(myleg, fig1_twopanel,
ncol=1, nrow=2,
rel_heights=c(0.1,1))
fig1_twopanel <- plot_grid(myleg, fig1_twopanel,
ncol=1, nrow=2,
rel_heights=c(0.1,1))
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jepg",
width=0.5, height=10, units="cm")
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=0.5, height=10, units="cm")
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
fig1 <- ggplot(spR, aes(x=totdist_percent, y=rich)) +
labs(x="Total Human Development (%)", y="Species Richness") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=spR, aes(x=totdist_percent, y=rich, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top") + font_sizes
# black and white
fig2 <- ggplot(veg_CSI_HF, aes(x=totdist_percent, y=CSI)) +
labs(x="Total Human Development (%)", y="CSI to human develpoment") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=veg_CSI_HF, aes(x=totdist_percent, y=CSI, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top") + font_sizes
# graphing specs
{
transparent_legend =  theme(
legend.position = "top",
legend.background = element_rect(fill = NA),
legend.key = element_rect(fill = NA,
color = NA))
transparent_plot =  theme(
plot.background = element_rect(fill = "white", color="white"),
panel.background = element_rect(fill = "white", color="white"),
panel.grid = element_blank())
font_sizes <- theme(
axis.text=element_text(size=10, color="black"),
axis.title=element_text(size=11),
legend.text=element_text(size=11),
legend.title=element_text(size=11),
strip.text=element_text(size=10))
}
fig1 <- ggplot(spR, aes(x=totdist_percent, y=rich)) +
labs(x="Total Human Development (%)", y="Species Richness") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=spR, aes(x=totdist_percent, y=rich, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top") + font_sizes
# black and white
fig2 <- ggplot(veg_CSI_HF, aes(x=totdist_percent, y=CSI)) +
labs(x="Total Human Development (%)", y="CSI to human develpoment") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=veg_CSI_HF, aes(x=totdist_percent, y=CSI, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top") + font_sizes
# two panel figure
myleg <- get_legend(fig1)
fig1_twopanel <- plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2,
labels="auto")
fig1_twopanel <- plot_grid(myleg, fig1_twopanel,
ncol=1, nrow=2,
rel_heights=c(0.1,1))
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
fig1_twopanel <- plot_grid(myleg, fig1_twopanel,
ncol=1, nrow=2,
rel_heights=c(0.1,1))
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
getwd
getwd()
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel_2.jpeg",
width=5, height=10, units="cm")
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
# two panel figure
myleg <- get_legend(fig1)
fig1_twopanel <- plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2,
labels="auto")
fig1_twopanel <- plot_grid(myleg, fig1_twopanel,
ncol=1, nrow=2,
rel_heights=c(0.1,1))
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
font_sizes <- theme(
axis.text=element_text(size=6, color="black"),
axis.title=element_text(size=8),
legend.text=element_text(size=6),
legend.title=element_text(size=8),
strip.text=element_text(size=6))
# 1. sp richness vs HF (i.e. IDH) ####
{
fig1 <- ggplot(spR, aes(x=totdist_percent, y=rich)) +
labs(x="Total Human Development (%)", y="Species Richness") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=spR, aes(x=totdist_percent, y=rich, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top") + font_sizes
# ggsave(plot=fig1,
#        filename="results/figs/fig1.jpeg",
#        width=10, height=8, units="cm")
}
# black and white
fig2 <- ggplot(veg_CSI_HF, aes(x=totdist_percent, y=CSI)) +
labs(x="Total Human Development (%)", y="CSI to human develpoment") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=veg_CSI_HF, aes(x=totdist_percent, y=CSI, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top") + font_sizes
# two panel figure
myleg <- get_legend(fig1)
fig1_twopanel <- plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2,
labels="auto")
fig1_twopanel <- plot_grid(myleg, fig1_twopanel,
ncol=1, nrow=2,
rel_heights=c(0.1,1))
fig1_twopanel
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
fig1_twopanel <- plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2,
labels="auto", label_size = 12)
fig1_twopanel <- plot_grid(myleg, fig1_twopanel,
ncol=1, nrow=2,
rel_heights=c(0.1,1))
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
# black and white
fig2 <- ggplot(veg_CSI_HF, aes(x=totdist_percent, y=CSI)) +
labs(x="Total Human Development (%)", y="CSI to HD") +
geom_point(alpha=0.5, color="grey70") +
geom_smooth(method="lm", formula=y~poly(x,2), se=F, color=1) +
geom_smooth(data=veg_CSI_HF, aes(x=totdist_percent, y=CSI, linetype=Protocol),
method="lm", formula=y~poly(x,2), se=F, color=1, size=0.5) +
scale_linetype_manual(values=c("dashed", "dotdash")) +
theme_classic() +
theme(legend.position = "top") + font_sizes
# two panel figure
myleg <- get_legend(fig1)
fig1_twopanel <- plot_grid(fig1 + theme(legend.position = "none"),
fig2 + theme(legend.position="none"),
ncol=1, nrow=2,
labels="auto", label_size = 12)
fig1_twopanel <- plot_grid(myleg, fig1_twopanel,
ncol=1, nrow=2,
rel_heights=c(0.1,1))
ggsave(plot=fig1_twopanel,
filename = "results/figs/fig1 - two panel.jpeg",
width=5, height=10, units="cm")
head(hf)
head(veg_exot)
ggplot(veg_exot, aes(x=totdist_percent, y=propexotic)) + geom_point()
ggplot(veg_exot, aes(x=totdist_percent, y=propexotic)) + geom_point(aes(color=rich))
ggplot(veg_exot, aes(x=totdist_percent, y=propexotic)) + geom_point(aes(color=rich)) + scale_color_gradient2(low="blue", high="red", midpoint=60)
head(hf_bin)
# prep data frames with 2  or 3 bins
{
library(vegan)
veg_hf <- veg_pa %>%
select(Latitude, Longitude, NRNAME, Protocol, WetlandType, Site, Year, Species, PA)
veg_hf <- veg_hf %>%
spread(key=Species, value=PA) %>%
gather(key=Species, value=PA, 8:ncol(.)) %>%
replace_na(list(PA=0)) %>%
spread(key=Species, value=PA)
hf_bin <- hf_tot
hf_bin$HFbin <- ntile(hf_bin$totdist_percent, n=10)
hf_bin %>% group_by(as.factor(HFbin)) %>% summarize(meandist=mean(totdist_percent),
meddist=median(totdist_percent))
veg_hf <- left_join(veg_hf,
select(hf_bin, -totdist_percent),
by=c("Latitude","Longitude", "NRNAME", "Protocol", "WetlandType", "Site", "Year"))
# veg_hf2 has most & least dist communities
veg_hf2 <- veg_hf %>% filter(HFbin==1 | HFbin==10) %>%
select(Latitude, Longitude, NRNAME, Protocol, WetlandType, Site, Year, HFbin, everything())
sptokeep2 <- colSums(veg_hf2[,9:ncol(veg_hf2)]) %>% data.frame()
sptokeep2$Species <- rownames(sptokeep2)
colnames(sptokeep2) <- c("Obs", "Species")
sptokeep2 <-  filter(sptokeep2, Obs > 1)
veg_hf2 <- veg_hf2 %>%
gather(Species, PA, 9:ncol(.)) %>%
filter(Species %in% sptokeep2$Species) %>%
spread(Species, PA)
# veg_hf3 has most, least, and intermed dist communities
veg_hf3 <- veg_hf %>% filter(HFbin==1 | HFbin==8 | HFbin==10) %>%
select(Latitude, Longitude, NRNAME, Protocol, WetlandType, Site, Year, HFbin, everything())
sptokeep3 <- colSums(veg_hf3[,9:ncol(veg_hf3)]) %>% data.frame()
sptokeep3$Species <- rownames(sptokeep3)
colnames(sptokeep3) <- c("Obs", "Species")
sptokeep3 <-  filter(sptokeep3, Obs > 1)
veg_hf3 <- veg_hf3 %>%
gather(Species, PA, 9:ncol(.)) %>%
filter(Species %in% sptokeep3$Species) %>%
spread(Species, PA)
}
head(hf_bin)
head(veg_exot)
left_join(select(Protocol, WetlandType, Year, Site, HFbin ),
veg_exot,
by=c("Protocol", "WetlandType", "Year", "Site")) %>% head()
left_join(select(hf_bin,Protocol, WetlandType, Year, Site, HFbin ),
veg_exot,
by=c("Protocol", "WetlandType", "Year", "Site")) %>% head()
left_join(select(ungroup(hf_bin),Protocol, WetlandType, Year, Site, HFbin ),
veg_exot,
by=c("Protocol", "WetlandType", "Year", "Site")) %>% head()
exot_bin <- left_join(select(ungroup(hf_bin),Protocol, WetlandType, Year, Site, HFbin ),
veg_exot,
by=c("Protocol", "WetlandType", "Year", "Site"))
View(exot_bin)
exot_bin2 <- exot_bin %>% filter(HFbin==1 | HFbin==10)
exot_bin2$UniqueID <- paste(exot_bin2$Protocol, exot_bin2$Site, sep="_")
exot_bin3 <- exot_bin %>% filter(HFbin==1 | HFbin==8 | HFbin==10)
exot_bin3$UniqueID <- paste(exot_bin3$Protocol, exot_bin3$Site, sep="_")
exot_bin3$HFbin <- recode(exot_bin3$HFbin, "1"="Low", "8"="Int.", "10"="High")
exot_bin3$HFbin <- factor(exot_bin3$HFbin, ordered=T, levels=c("Low", "Int.", "High"))
ggplot(exot_bin3, aes(x=HFbin, y=totdist_percent)) +
geom_boxplot(fill="grey80") +
labs(x="Disturbance Level", y="Prop. Exotics (%)")
ggsave(plot=fig7,
filename="results/figs/fig7.jpeg",
width=12, height=10, units="cm")
fig7 <- ggplot(exot_bin3, aes(x=HFbin, y=totdist_percent)) +
geom_boxplot(fill="grey80") +
labs(x="Disturbance Level", y="Prop. Exotics (%)")
ggsave(plot=fig7,
filename="results/figs/fig7.jpeg",
width=12, height=10, units="cm")
ggsave(plot=fig7,
filename="results/figs/fig7.jpeg",
width=8, height=8, units="cm")
fig7 <- ggplot(exot_bin3, aes(x=HFbin, y=totdist_percent)) +
geom_boxplot(fill="grey80") +
labs(x="Disturbance Level", y="Prop. Exotics (%)") + font_sizes
ggsave(plot=fig7,
filename="results/figs/fig7.jpeg",
width=8, height=8, units="cm")
exot_bin %>%
group_by(as.factor(HFbin)) %>%
summarize(meandist=mean(totdist_percent),
meddist=median(totdist_percent))
head(exot_bin)
exot_bin %>%
group_by(as.factor(HFbin)) %>%
summarize(meanexot=mean(propexotic),
medexot=median(propexotic))
exot_bin %>%
group_by(as.factor(HFbin)) %>%
summarize(minexot=min(propexotic),
medexot=median(propexotic),
maxexot=max(propexotic))
?confint
confint(exot_bin$propexotic)
confint(exot_bim)
head(exot_bin)
?ci
?geom_boxplot
?IQR
exot_bin %>%
group_by(as.factor(HFbin)) %>%
summarize(medexot=median(propexotic),
IQRexot=IQR(propexotic))
